FROM node:20
WORKDIR /app
COPY package.json yarn.lock ./
RUN yarn install
COPY . .

ARG VITE_IS_AUTH0_DISABLED
ENV VITE_IS_AUTH0_DISABLED=${VITE_IS_AUTH0_DISABLED}

ARG VITE_MOCK_USER_ID
ENV VITE_MOCK_USER_ID=${VITE_MOCK_USER_ID}

ARG VITE_MODE=staging
ENV VITE_MODE=${VITE_MODE}

RUN yarn build --mode ${VITE_MODE}
EXPOSE 3001
CMD ["yarn", "start"]
